(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const m of r.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&c(m)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}})();const b=async t=>{try{const e=await fetch(`https://api.jikan.moe/v4/anime/${t}/full`);if(!e.ok)throw Error(`Fetch failed. ${e.status} ${e.statusText}`);return(await e.json()).data}catch(e){return console.warn(`Error: ${e.message}`),null}},j=async()=>{try{const t=await fetch("https://api.jikan.moe/v4/top/anime?type=tv");if(!t.ok)throw Error(`Fetch failed. ${t.status} ${t.statusText}`);return{data:(await t.json()).data,error:null}}catch(t){return{data:null,error:t}}},k=async t=>{try{const e=await fetch(`https://api.jikan.moe/v4/anime?q=${t}/sfw`);if(!e.ok)throw Error(`Fetch failed. ${e.status} ${e.statusText}`);return{data:(await e.json()).data,error:null}}catch(e){return{data:null,error:e}}},q=async t=>{try{const e=await fetch(`https://api.jikan.moe/v4/anime/${t}/characters`);if(!e.ok)throw Error(`Fetch failed. ${e.status} ${e.statusText}`);return{data:(await e.json()).data,error:null}}catch(e){return{data:null,error:e}}},S=async t=>{try{const e=await fetch(`https://api.jikan.moe/v4/anime?genres=${t}`);if(!e.ok)throw Error(`Fetch failed. ${e.status} ${e.statusText}`);return(await e.json()).data}catch(e){return console.warn(`Error: ${e.message}`),null}},l=document.querySelector("#anime-details"),v=document.querySelector("#anime-list"),T=document.querySelector("#anime-count"),D=async t=>{l.innerHTML="",l.showModal();const e=document.createElement("h2");e.textContent=t.title;const n=document.createElement("img");n.src=t.images.jpg.image_url,n.alt=t.title;const c=document.createElement("p");c.textContent=t.synopsis;const a=document.createElement("p");a.textContent=`Rating: ${t.score}/10`;const r=document.createElement("ul");r.className="genre-list",t.genres.forEach(s=>{const o=document.createElement("li");o.textContent=s.name,o.dataset.genreId=s.mal_id,r.appendChild(o)});const m=document.createElement("h3");m.textContent="Characters:";const h=document.createElement("button");h.textContent="close",h.addEventListener("click",()=>{l.close()});const f=document.createElement("ul"),L=await q(t.mal_id);for(let s=0;s<10;s++){const o=L.data[s],i=document.createElement("li"),x=document.createElement("p"),p=document.createElement("img"),C=document.createElement("p");x.textContent=o.character.name,p.src=o.character.images.jpg.image_url,p.alt=`Image of ${o.character.name}`,p.style.width="50px",C.textContent=`Role: ${o.role}`,i.append(x,p,C),i.className="character",f.append(i)}f.className="anime-characters";const u=document.createElement("form");u.id="rating";for(let s=5;s>=1;s--){const o=document.createElement("input");o.type="radio",o.id=`star${s}`,o.name="rating",o.value=s;const i=document.createElement("label");i.htmlFor=o.id,i.title=`${s} star${s>1?"s":""}`,i.textContent="☆",document.createElement("button"),u.append(o,i)}const g=document.createElement("button");g.type="submit",g.textContent="Submit Rating",u.append(g),l.append(e,n,c,a,r,m,f,u,h)},$=t=>{v.innerHTML="",T.textContent=t.data.length,t.data.forEach(e=>{const n=document.createElement("li"),c=document.createElement("img"),a=document.createElement("h3");n.dataset.animeId=e.mal_id,c.src=e.images.jpg.image_url,c.alt=`Image of ${e.title}`,a.textContent=e.title,n.append(c,a),v.append(n)})};l.addEventListener("click",t=>{t.target===l&&l.close()});const d=document.querySelector("#error-message"),F=document.querySelector("#anime-list"),y=document.querySelector("#search-form"),w=document.querySelector("#anime-details");F.addEventListener("click",async t=>{const e=t.target.closest("li");if(!e)return;const n=await b(e.dataset.animeId);if(!n){d.textContent="Failed to load anime details.",setTimeout(()=>d.textContent="",2e3);return}D(n)});const E=await j();E.error?d.textContent=E.error.message:$(E);y.addEventListener("submit",async t=>{try{t.preventDefault();const e=y.elements.query.value,n=await k(e);$(n),y.reset()}catch(e){d.textContent=e.message}});w.addEventListener("click",async t=>{const e=t.target.dataset.genreId;if(!e)return;const n=await S(e);n&&(w.close(),$({data:n}),window.scrollTo({top:0,behavior:"smooth"}))});w.addEventListener("submit",t=>{if(t.target.id!=="rating")return;t.preventDefault();const e=t.target.querySelector('input[name="rating"]:checked')?.value;if(!e){d.textContent="Please select a rating.",setTimeout(()=>d.textContent="",2e3);return}const n=document.createElement("p");n.textContent=`⭐ Thank you for rating ${e} star(s)!`,t.target.replaceWith(n)});
