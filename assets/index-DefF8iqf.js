(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}})();const j=async e=>{try{const t=await fetch(`https://api.jikan.moe/v4/anime/${e}/full`);if(!t.ok)throw Error(`Fetch failed. ${t.status} ${t.statusText}`);return(await t.json()).data}catch(t){return console.warn(`Error: ${t.message}`),null}},k=async()=>{try{const e=await fetch("https://api.jikan.moe/v4/top/anime?type=tv");if(!e.ok)throw Error(`Fetch failed. ${e.status} ${e.statusText}`);return{data:(await e.json()).data,error:null}}catch(e){return{data:null,error:e}}},I=async e=>{try{const t=await fetch(`https://api.jikan.moe/v4/anime?q=${e}&sfw=true`);if(!t.ok)throw Error(`Fetch failed. ${t.status} ${t.statusText}`);return{data:(await t.json()).data,error:null}}catch(t){return{data:null,error:t}}},S=async e=>{try{const t=await fetch(`https://api.jikan.moe/v4/anime/${e}/characters`);if(!t.ok)throw Error(`Fetch failed. ${t.status} ${t.statusText}`);return{data:(await t.json()).data,error:null}}catch(t){return{data:null,error:t}}},T=async e=>{try{const t=await fetch(`https://api.jikan.moe/v4/anime?genres=${e}`);if(!t.ok)throw Error(`Fetch failed. ${t.status} ${t.statusText}`);return(await t.json()).data}catch(t){return console.warn(`Error: ${t.message}`),null}},q=async e=>{try{const t=await fetch(`https://api.jikan.moe/v4/characters/${e}`);if(!t.ok)throw Error(`Fetch failed. ${t.status} ${t.statusText}`);return{data:(await t.json()).data,error:null}}catch(t){return{data:null,error:t}}},i=document.querySelector("#anime-details"),L=document.querySelector("#anime-list"),D=document.querySelector("#anime-count"),F=async e=>{i.innerHTML="",i.showModal();const t=document.createElement("h2");t.textContent=e.title;const a=document.createElement("img");a.src=e.images.jpg.image_url,a.alt=e.title;const o=document.createElement("p");o.textContent=e.synopsis;const n=document.createElement("p");n.textContent=`Rating: ${e.score}/10`;const s=document.createElement("ul");s.className="genre-list",e.genres.forEach(c=>{const r=document.createElement("li");r.textContent=c.name,r.dataset.genreId=c.mal_id,s.appendChild(r)});const d=document.createElement("h3");d.textContent="Characters:";const u=document.createElement("button");u.textContent="close",u.classList.add("close"),u.addEventListener("click",()=>{i.close()});const y=document.createElement("ul"),b=await S(e.mal_id);for(let c=0;c<10;c++){const r=b.data[c],l=document.createElement("li"),C=document.createElement("p"),g=document.createElement("img"),v=document.createElement("p");C.textContent=r.character.name,g.src=r.character.images.jpg.image_url,g.alt=`Image of ${r.character.name}`,g.style.width="50px",v.textContent=`Role: ${r.role}`,l.append(C,g,v),l.dataset.characterId=r.character.mal_id,y.append(l)}y.className="anime-characters";const E=document.createElement("div");E.classList.add("rating-wrapper");const p=document.createElement("form");p.id="rating";for(let c=5;c>=1;c--){const r=document.createElement("input");r.type="radio",r.id=`star${c}`,r.name="rating",r.value=c;const l=document.createElement("label");l.htmlFor=r.id,l.title=`${c} star${c>1?"s":""}`,l.textContent="☆",p.append(r,l)}const h=document.createElement("button");h.type="submit",h.textContent="Submit Rating",h.classList.add("submit-btn"),p.append(h),E.append(p),i.append(t,a,o,n,s,d,y,E,u)},x=e=>{L.innerHTML="",D.textContent=e.data.length,e.data.forEach(t=>{const a=document.createElement("li"),o=document.createElement("img"),n=document.createElement("h3");a.dataset.animeId=t.mal_id,o.src=t.images.jpg.image_url,o.alt=`Image of ${t.title}`,n.textContent=t.title,a.append(o,n),L.append(a)})};i.addEventListener("click",e=>{e.target===i&&i.close()});const A=e=>{i.innerHTML="",i.showModal();const t=document.createElement("h3"),a=document.createElement("img"),o=document.createElement("h4"),n=document.createElement("p");t.textContent=e.data.name,a.src=e.data.images.jpg.image_url,a.alt=`Image of ${e.data.name}`,o.textContent="About",n.textContent=e.data.about,i.append(t,a,o,n)},m=document.querySelector("#error-message"),_=document.querySelector("#anime-list"),w=document.querySelector("#search-form"),f=document.querySelector("#anime-details");_.addEventListener("click",async e=>{const t=e.target.closest("li");if(!t)return;const a=await j(t.dataset.animeId);if(!a){m.textContent="Failed to load anime details.",setTimeout(()=>m.textContent="",2e3);return}F(a)});const $=await k();$.error?m.textContent=$.error.message:x($);w.addEventListener("submit",async e=>{try{e.preventDefault();const t=w.elements.query.value,a=await I(t);x(a),w.reset()}catch(t){m.textContent=t.message}});f.addEventListener("click",async e=>{const t=e.target.dataset.genreId;if(!t)return;const a=await T(t);a&&(f.close(),x({data:a}),window.scrollTo({top:0,behavior:"smooth"}))});f.addEventListener("submit",e=>{if(e.target.id!=="rating")return;e.preventDefault();const t=e.target.querySelector('input[name="rating"]:checked')?.value;if(!t){m.textContent="Please select a rating.",setTimeout(()=>m.textContent="",2e3);return}const a=document.createElement("p");a.textContent=`⭐ Thank you for rating ${t} star(s)!`,e.target.replaceWith(a)});f.addEventListener("click",async e=>{const t=e.target.closest("li")?.dataset.characterId;if(!t)return;const a=await q(t);!a||a.error||A(a)});
