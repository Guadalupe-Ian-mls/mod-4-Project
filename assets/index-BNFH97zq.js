(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function a(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(n){if(n.ep)return;n.ep=!0;const c=a(n);fetch(n.href,c)}})();const b=async e=>{try{const t=await fetch(`https://api.jikan.moe/v4/anime/${e}/full`);if(!t.ok)throw Error(`Fetch failed. ${t.status} ${t.statusText}`);return(await t.json()).data}catch(t){return console.warn(`Error: ${t.message}`),null}},j=async()=>{try{const e=await fetch("https://api.jikan.moe/v4/top/anime?type=tv");if(!e.ok)throw Error(`Fetch failed. ${e.status} ${e.statusText}`);return{data:(await e.json()).data,error:null}}catch(e){return{data:null,error:e}}},k=async e=>{try{const t=await fetch(`https://api.jikan.moe/v4/anime?q=${e}&sfw=true`);if(!t.ok)throw Error(`Fetch failed. ${t.status} ${t.statusText}`);return{data:(await t.json()).data,error:null}}catch(t){return{data:null,error:t}}},I=async e=>{try{const t=await fetch(`https://api.jikan.moe/v4/anime/${e}/characters`);if(!t.ok)throw Error(`Fetch failed. ${t.status} ${t.statusText}`);return{data:(await t.json()).data,error:null}}catch(t){return{data:null,error:t}}},S=async e=>{try{const t=await fetch(`https://api.jikan.moe/v4/anime?genres=${e}`);if(!t.ok)throw Error(`Fetch failed. ${t.status} ${t.statusText}`);return(await t.json()).data}catch(t){return console.warn(`Error: ${t.message}`),null}},T=async e=>{try{const t=await fetch(`https://api.jikan.moe/v4/characters/${e}`);if(!t.ok)throw Error(`Fetch failed. ${t.status} ${t.statusText}`);return{data:(await t.json()).data,error:null}}catch(t){return{data:null,error:t}}},i=document.querySelector("#anime-details"),v=document.querySelector("#anime-list"),q=document.querySelector("#anime-count"),D=async e=>{i.innerHTML="",i.showModal();const t=document.createElement("h2");t.textContent=e.title;const a=document.createElement("img");a.src=e.images.jpg.image_url,a.alt=e.title;const o=document.createElement("p");o.textContent=e.synopsis;const n=document.createElement("p");n.textContent=`Rating: ${e.score}/10`;const c=document.createElement("ul");c.className="genre-list",e.genres.forEach(s=>{const r=document.createElement("li");r.textContent=s.name,r.dataset.genreId=s.mal_id,c.appendChild(r)});const d=document.createElement("h3");d.textContent="Characters:";const f=document.createElement("button");f.textContent="close",f.addEventListener("click",()=>{i.close()});const g=document.createElement("ul"),L=await I(e.mal_id);for(let s=0;s<10;s++){const r=L.data[s],l=document.createElement("li"),x=document.createElement("p"),h=document.createElement("img"),C=document.createElement("p");x.textContent=r.character.name,h.src=r.character.images.jpg.image_url,h.alt=`Image of ${r.character.name}`,h.style.width="50px",C.textContent=`Role: ${r.role}`,l.append(x,h,C),l.dataset.characterId=r.character.mal_id,g.append(l)}g.className="anime-characters";const u=document.createElement("form");u.id="rating";for(let s=5;s>=1;s--){const r=document.createElement("input");r.type="radio",r.id=`star${s}`,r.name="rating",r.value=s;const l=document.createElement("label");l.htmlFor=r.id,l.title=`${s} star${s>1?"s":""}`,l.textContent="☆",u.append(r,l)}const y=document.createElement("button");y.type="submit",y.textContent="Submit Rating",u.append(y),i.append(t,a,o,n,c,d,g,u,f)},$=e=>{v.innerHTML="",q.textContent=e.data.length,e.data.forEach(t=>{const a=document.createElement("li"),o=document.createElement("img"),n=document.createElement("h3");a.dataset.animeId=t.mal_id,o.src=t.images.jpg.image_url,o.alt=`Image of ${t.title}`,n.textContent=t.title,a.append(o,n),v.append(a)})};i.addEventListener("click",e=>{e.target===i&&i.close()});const F=e=>{i.innerHTML="",i.showModal();const t=document.createElement("h3"),a=document.createElement("img"),o=document.createElement("h4"),n=document.createElement("p");t.textContent=e.data.name,a.src=e.data.images.jpg.image_url,a.alt=`Image of ${e.data.name}`,o.textContent="About",n.textContent=e.data.about,i.append(t,a,o,n)},m=document.querySelector("#error-message"),A=document.querySelector("#anime-list"),E=document.querySelector("#search-form"),p=document.querySelector("#anime-details");A.addEventListener("click",async e=>{const t=e.target.closest("li");if(!t)return;const a=await b(t.dataset.animeId);if(!a){m.textContent="Failed to load anime details.",setTimeout(()=>m.textContent="",2e3);return}D(a)});const w=await j();w.error?m.textContent=w.error.message:$(w);E.addEventListener("submit",async e=>{try{e.preventDefault();const t=E.elements.query.value,a=await k(t);$(a),E.reset()}catch(t){m.textContent=t.message}});p.addEventListener("click",async e=>{const t=e.target.dataset.genreId;if(!t)return;const a=await S(t);a&&(p.close(),$({data:a}),window.scrollTo({top:0,behavior:"smooth"}))});p.addEventListener("submit",e=>{if(e.target.id!=="rating")return;e.preventDefault();const t=e.target.querySelector('input[name="rating"]:checked')?.value;if(!t){m.textContent="Please select a rating.",setTimeout(()=>m.textContent="",2e3);return}const a=document.createElement("p");a.textContent=`⭐ Thank you for rating ${t} star(s)!`,e.target.replaceWith(a)});p.addEventListener("click",async e=>{const t=e.target.closest("li")?.dataset.characterId;if(!t)return;const a=await T(t);!a||a.error||F(a)});
